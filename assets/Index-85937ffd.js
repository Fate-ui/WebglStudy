var ft=Object.defineProperty;var pt=(e,t,o)=>t in e?ft(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var g=(e,t,o)=>(pt(e,typeof t!="symbol"?t+"":t,o),o),Oe=(e,t,o)=>{if(!t.has(e))throw TypeError("Cannot "+o)};var he=(e,t,o)=>(Oe(e,t,"read from private field"),o?o.call(e):t.get(e)),N=(e,t,o)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,o)};var Y=(e,t,o)=>(Oe(e,t,"access private method"),o);import{a as ke,b as Ae,d as Se,j as mt,f as vt}from"./base-6a0060ca.js";import{a3 as yt,l as q,a4 as ht,a5 as ve,E as Xe,a6 as bt,X as j,_ as gt,W as be,k as L,d as F,Q as qe,a as i,L as I,B as Ce,C as wt,q as W,y as Et,I as De,f as H,o as P,c as X,h as D,M as U,t as ne,w as B,i as ae,N as St,O as re,H as Je,V as Ct,J as Tt,z as _t,P as Lt,a7 as kt,A as At,T as Ze,a8 as Rt,s as xt,p as Mt,F as Ot}from"./index-88e77320.js";import{O as Dt}from"./OrbitControls-e8af0deb.js";import{S as It,M as Pt,R as Bt}from"./StaticGeometryGenerator-0ba4b1dd.js";import{V as G,y as Ft,M as Nt,aT as Ie,T as Ut,aU as Vt,b as Te,f as $t,$ as Wt,g as Qe,K as Pe,J as Be,S as Kt,P as jt,W as Ht,a5 as Yt,a as Gt,E as zt}from"./three.module-64cab3bc.js";import{d as Xt}from"./index-1a26f821.js";import{u as le}from"./index-034fbea2.js";import{G as qt}from"./GLTFLoader-50cfc617.js";import{R as Jt}from"./Reflector-79d58935.js";import{E as Zt}from"./index-60bef513.js";import{i as Qt,C as eo,u as Fe}from"./index-9232cc37.js";import{_ as Re,u as Ne,w as to}from"./plugin-vue_export-helper-b8a40766.js";import{b as oo,c as so,a as no}from"./use-global-config-76ac8553.js";import{i as J,b as _e,h as Ue,g as ao,a as ro,r as lo,u as Ve}from"./style-fa240d4e.js";import{t as io,U as et}from"./event-2c073216.js";import{_ as co}from"./_plugin-vue_export-helper-c27b6911.js";function uo(e){return e==null}let Q;const fo=e=>{var t;if(!J)return 0;if(Q!==void 0)return Q;const o=document.createElement("div");o.className=`${e}-scrollbar__wrap`,o.style.visibility="hidden",o.style.width="100px",o.style.position="absolute",o.style.top="-9999px",document.body.appendChild(o);const s=o.offsetWidth;o.style.overflow="scroll";const n=document.createElement("div");n.style.width="100%",o.appendChild(n);const r=n.offsetWidth;return(t=o.parentNode)==null||t.removeChild(o),Q=s-r,Q},po=(...e)=>t=>{e.forEach(o=>{yt(o)?o(t):o.value=t})},tt={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"};var se=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(se||{});const mo=(e,t,o)=>{let s={offsetX:0,offsetY:0};const n=c=>{const u=c.clientX,d=c.clientY,{offsetX:b,offsetY:w}=s,E=e.value.getBoundingClientRect(),m=E.left,a=E.top,f=E.width,h=E.height,v=document.documentElement.clientWidth,y=document.documentElement.clientHeight,R=-m+b,_=-a+w,x=v-m-f+b,T=y-a-h+w,M=k=>{const p=Math.min(Math.max(b+k.clientX-u,R),x),A=Math.min(Math.max(w+k.clientY-d,_),T);s={offsetX:p,offsetY:A},e.value.style.transform=`translate(${_e(p)}, ${_e(A)})`},S=()=>{document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",S)};document.addEventListener("mousemove",M),document.addEventListener("mouseup",S)},r=()=>{t.value&&e.value&&t.value.addEventListener("mousedown",n)},l=()=>{t.value&&e.value&&t.value.removeEventListener("mousedown",n)};q(()=>{ht(()=>{o.value?r():l()})}),ve(()=>{l()})},vo=(e,t={})=>{Xe(e)||io("[useLockscreen]","You need to pass a ref param to this function");const o=t.ns||ke("popup"),s=bt(()=>o.bm("parent","hidden"));if(!J||Ue(document.body,s.value))return;let n=0,r=!1,l="0";const c=()=>{setTimeout(()=>{lo(document==null?void 0:document.body,s.value),r&&document&&(document.body.style.width=l)},200)};j(e,u=>{if(!u){c();return}r=!Ue(document.body,s.value),r&&(l=document.body.style.width),n=fo(o.namespace.value);const d=document.documentElement.clientHeight<document.body.scrollHeight,b=ao(document.body,"overflowY");n>0&&(d||b==="scroll")&&r&&(document.body.style.width=`calc(100% - ${n}px)`),ro(document.body,s.value)}),gt(()=>c())},ot=e=>{if(!e)return{onClick:be,onMousedown:be,onMouseup:be};let t=!1,o=!1;return{onClick:l=>{t&&o&&e(l),t=o=!1},onMousedown:l=>{t=l.target===l.currentTarget},onMouseup:l=>{o=l.target===l.currentTarget}}};let z=[];const $e=e=>{const t=e;t.key===tt.esc&&z.forEach(o=>o(t))},yo=e=>{q(()=>{z.length===0&&document.addEventListener("keydown",$e),J&&z.push(e)}),ve(()=>{z=z.filter(t=>t!==e),z.length===0&&J&&document.removeEventListener("keydown",$e)})},ge="focus-trap.focus-after-trapped",we="focus-trap.focus-after-released",ho="focus-trap.focusout-prevented",We={cancelable:!0,bubbles:!1},bo={cancelable:!0,bubbles:!1},Ke="focusAfterTrapped",je="focusAfterReleased",st=Symbol("elFocusTrap"),xe=L(),ye=L(0),Me=L(0);let ee=0;const nt=e=>{const t=[],o=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const n=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||n?NodeFilter.FILTER_SKIP:s.tabIndex>=0||s===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;o.nextNode();)t.push(o.currentNode);return t},He=(e,t)=>{for(const o of e)if(!go(o,t))return o},go=(e,t)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},wo=e=>{const t=nt(e),o=He(t,e),s=He(t.reverse(),e);return[o,s]},Eo=e=>e instanceof HTMLInputElement&&"select"in e,V=(e,t)=>{if(e&&e.focus){const o=document.activeElement;e.focus({preventScroll:!0}),Me.value=window.performance.now(),e!==o&&Eo(e)&&t&&e.select()}};function Ye(e,t){const o=[...e],s=e.indexOf(t);return s!==-1&&o.splice(s,1),o}const So=()=>{let e=[];return{push:s=>{const n=e[0];n&&s!==n&&n.pause(),e=Ye(e,s),e.unshift(s)},remove:s=>{var n,r;e=Ye(e,s),(r=(n=e[0])==null?void 0:n.resume)==null||r.call(n)}}},Co=(e,t=!1)=>{const o=document.activeElement;for(const s of e)if(V(s,t),document.activeElement!==o)return},Ge=So(),To=()=>ye.value>Me.value,te=()=>{xe.value="pointer",ye.value=window.performance.now()},ze=()=>{xe.value="keyboard",ye.value=window.performance.now()},_o=()=>(q(()=>{ee===0&&(document.addEventListener("mousedown",te),document.addEventListener("touchstart",te),document.addEventListener("keydown",ze)),ee++}),ve(()=>{ee--,ee<=0&&(document.removeEventListener("mousedown",te),document.removeEventListener("touchstart",te),document.removeEventListener("keydown",ze))}),{focusReason:xe,lastUserFocusTimestamp:ye,lastAutomatedFocusTimestamp:Me}),oe=e=>new CustomEvent(ho,{...bo,detail:e}),Lo=F({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[Ke,je,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const o=L();let s,n;const{focusReason:r}=_o();yo(a=>{e.trapped&&!l.paused&&t("release-requested",a)});const l={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},c=a=>{if(!e.loop&&!e.trapped||l.paused)return;const{key:f,altKey:h,ctrlKey:v,metaKey:y,currentTarget:R,shiftKey:_}=a,{loop:x}=e,T=f===tt.tab&&!h&&!v&&!y,M=document.activeElement;if(T&&M){const S=R,[k,p]=wo(S);if(k&&p){if(!_&&M===p){const C=oe({focusReason:r.value});t("focusout-prevented",C),C.defaultPrevented||(a.preventDefault(),x&&V(k,!0))}else if(_&&[k,S].includes(M)){const C=oe({focusReason:r.value});t("focusout-prevented",C),C.defaultPrevented||(a.preventDefault(),x&&V(p,!0))}}else if(M===S){const C=oe({focusReason:r.value});t("focusout-prevented",C),C.defaultPrevented||a.preventDefault()}}};qe(st,{focusTrapRef:o,onKeydown:c}),j(()=>e.focusTrapEl,a=>{a&&(o.value=a)},{immediate:!0}),j([o],([a],[f])=>{a&&(a.addEventListener("keydown",c),a.addEventListener("focusin",b),a.addEventListener("focusout",w)),f&&(f.removeEventListener("keydown",c),f.removeEventListener("focusin",b),f.removeEventListener("focusout",w))});const u=a=>{t(Ke,a)},d=a=>t(je,a),b=a=>{const f=i(o);if(!f)return;const h=a.target,v=a.relatedTarget,y=h&&f.contains(h);e.trapped||v&&f.contains(v)||(s=v),y&&t("focusin",a),!l.paused&&e.trapped&&(y?n=h:V(n,!0))},w=a=>{const f=i(o);if(!(l.paused||!f))if(e.trapped){const h=a.relatedTarget;!uo(h)&&!f.contains(h)&&setTimeout(()=>{if(!l.paused&&e.trapped){const v=oe({focusReason:r.value});t("focusout-prevented",v),v.defaultPrevented||V(n,!0)}},0)}else{const h=a.target;h&&f.contains(h)||t("focusout",a)}};async function E(){await Ce();const a=i(o);if(a){Ge.push(l);const f=a.contains(document.activeElement)?s:document.activeElement;if(s=f,!a.contains(f)){const v=new Event(ge,We);a.addEventListener(ge,u),a.dispatchEvent(v),v.defaultPrevented||Ce(()=>{let y=e.focusStartEl;wt(y)||(V(y),document.activeElement!==y&&(y="first")),y==="first"&&Co(nt(a),!0),(document.activeElement===f||y==="container")&&V(a)})}}}function m(){const a=i(o);if(a){a.removeEventListener(ge,u);const f=new CustomEvent(we,{...We,detail:{focusReason:r.value}});a.addEventListener(we,d),a.dispatchEvent(f),!f.defaultPrevented&&(r.value=="keyboard"||!To()||a.contains(document.activeElement))&&V(s??document.body),a.removeEventListener(we,d),Ge.remove(l)}}return q(()=>{e.trapped&&E(),j(()=>e.trapped,a=>{a?E():m()})}),ve(()=>{e.trapped&&m()}),{onKeydown:c}}});function ko(e,t,o,s,n,r){return I(e.$slots,"default",{handleKeydown:e.onKeydown})}var Ao=Re(Lo,[["render",ko],["__file","/home/runner/work/element-plus/element-plus/packages/components/focus-trap/src/focus-trap.vue"]]);const Ro=Ae({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:Se([String,Array,Object])},zIndex:{type:Se([String,Number])}}),xo={click:e=>e instanceof MouseEvent},Mo="overlay";var Oo=F({name:"ElOverlay",props:Ro,emits:xo,setup(e,{slots:t,emit:o}){const s=ke(Mo),n=u=>{o("click",u)},{onClick:r,onMousedown:l,onMouseup:c}=ot(e.customMaskEvent?void 0:n);return()=>e.mask?W("div",{class:[s.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:r,onMousedown:l,onMouseup:c},[I(t,"default")],se.STYLE|se.CLASS|se.PROPS,["onClick","onMouseup","onMousedown"]):Et("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[I(t,"default")])}});const Do=Oo,at=Symbol("dialogInjectionKey"),rt=Ae({center:Boolean,alignCenter:Boolean,closeIcon:{type:Qt},customClass:{type:String,default:""},draggable:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),Io={close:()=>!0},Po=["aria-level"],Bo=["aria-label"],Fo=["id"],No=F({name:"ElDialogContent"}),Uo=F({...No,props:rt,emits:Io,setup(e){const t=e,{t:o}=oo(),{Close:s}=eo,{dialogRef:n,headerRef:r,bodyId:l,ns:c,style:u}=De(at),{focusTrapRef:d}=De(st),b=H(()=>[c.b(),c.is("fullscreen",t.fullscreen),c.is("draggable",t.draggable),c.is("align-center",t.alignCenter),{[c.m("center")]:t.center},t.customClass]),w=po(d,n),E=H(()=>t.draggable);return mo(n,r,E),(m,a)=>(P(),X("div",{ref:i(w),class:U(i(b)),style:Je(i(u)),tabindex:"-1"},[D("header",{ref_key:"headerRef",ref:r,class:U(i(c).e("header"))},[I(m.$slots,"header",{},()=>[D("span",{role:"heading","aria-level":m.ariaLevel,class:U(i(c).e("title"))},ne(m.title),11,Po)]),m.showClose?(P(),X("button",{key:0,"aria-label":i(o)("el.dialog.close"),class:U(i(c).e("headerbtn")),type:"button",onClick:a[0]||(a[0]=f=>m.$emit("close"))},[W(i(Zt),{class:U(i(c).e("close"))},{default:B(()=>[(P(),ae(St(m.closeIcon||i(s))))]),_:1},8,["class"])],10,Bo)):re("v-if",!0)],2),D("div",{id:i(l),class:U(i(c).e("body"))},[I(m.$slots,"default")],10,Fo),m.$slots.footer?(P(),X("footer",{key:0,class:U(i(c).e("footer"))},[I(m.$slots,"footer")],2)):re("v-if",!0)],6))}});var Vo=Re(Uo,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog-content.vue"]]);const $o=Ae({...rt,appendToBody:Boolean,beforeClose:{type:Se(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1},headerAriaLevel:{type:String,default:"2"}}),Wo={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[et]:e=>mt(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},Ko=(e,t)=>{const s=Ct().emit,{nextZIndex:n}=so();let r="";const l=Ne(),c=Ne(),u=L(!1),d=L(!1),b=L(!1),w=L(e.zIndex||n());let E,m;const a=no("namespace",vt),f=H(()=>{const O={},K=`--${a.value}-dialog`;return e.fullscreen||(e.top&&(O[`${K}-margin-top`]=e.top),e.width&&(O[`${K}-width`]=_e(e.width))),O}),h=H(()=>e.alignCenter?{display:"flex"}:{});function v(){s("opened")}function y(){s("closed"),s(et,!1),e.destroyOnClose&&(b.value=!1)}function R(){s("close")}function _(){m==null||m(),E==null||E(),e.openDelay&&e.openDelay>0?{stop:E}=Ve(()=>S(),e.openDelay):S()}function x(){E==null||E(),m==null||m(),e.closeDelay&&e.closeDelay>0?{stop:m}=Ve(()=>k(),e.closeDelay):k()}function T(){function O(K){K||(d.value=!0,u.value=!1)}e.beforeClose?e.beforeClose(O):x()}function M(){e.closeOnClickModal&&T()}function S(){J&&(u.value=!0)}function k(){u.value=!1}function p(){s("openAutoFocus")}function A(){s("closeAutoFocus")}function C(O){var K;((K=O.detail)==null?void 0:K.focusReason)==="pointer"&&O.preventDefault()}e.lockScroll&&vo(u);function Z(){e.closeOnPressEscape&&T()}return j(()=>e.modelValue,O=>{O?(d.value=!1,_(),b.value=!0,w.value=e.zIndex?w.value++:n(),Ce(()=>{s("open"),t.value&&(t.value.scrollTop=0)})):u.value&&x()}),j(()=>e.fullscreen,O=>{t.value&&(O?(r=t.value.style.transform,t.value.style.transform=""):t.value.style.transform=r)}),q(()=>{e.modelValue&&(u.value=!0,b.value=!0,_())}),{afterEnter:v,afterLeave:y,beforeLeave:R,handleClose:T,onModalClick:M,close:x,doClose:k,onOpenAutoFocus:p,onCloseAutoFocus:A,onCloseRequested:Z,onFocusoutPrevented:C,titleId:l,bodyId:c,closed:d,style:f,overlayDialogStyle:h,rendered:b,visible:u,zIndex:w}},jo=["aria-label","aria-labelledby","aria-describedby"],Ho=F({name:"ElDialog",inheritAttrs:!1}),Yo=F({...Ho,props:$o,emits:Wo,setup(e,{expose:t}){const o=e,s=Tt();Fe({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},H(()=>!!s.title)),Fe({scope:"el-dialog",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/dialog.html#attributes",type:"Attribute"},H(()=>!!o.customClass));const n=ke("dialog"),r=L(),l=L(),c=L(),{visible:u,titleId:d,bodyId:b,style:w,overlayDialogStyle:E,rendered:m,zIndex:a,afterEnter:f,afterLeave:h,beforeLeave:v,handleClose:y,onModalClick:R,onOpenAutoFocus:_,onCloseAutoFocus:x,onCloseRequested:T,onFocusoutPrevented:M}=Ko(o,r);qe(at,{dialogRef:r,headerRef:l,bodyId:b,ns:n,rendered:m,style:w});const S=ot(R),k=H(()=>o.draggable&&!o.fullscreen);return t({visible:u,dialogContentRef:c}),(p,A)=>(P(),ae(Rt,{to:"body",disabled:!p.appendToBody},[W(Ze,{name:"dialog-fade",onAfterEnter:i(f),onAfterLeave:i(h),onBeforeLeave:i(v),persisted:""},{default:B(()=>[_t(W(i(Do),{"custom-mask-event":"",mask:p.modal,"overlay-class":p.modalClass,"z-index":i(a)},{default:B(()=>[D("div",{role:"dialog","aria-modal":"true","aria-label":p.title||void 0,"aria-labelledby":p.title?void 0:i(d),"aria-describedby":i(b),class:U(`${i(n).namespace.value}-overlay-dialog`),style:Je(i(E)),onClick:A[0]||(A[0]=(...C)=>i(S).onClick&&i(S).onClick(...C)),onMousedown:A[1]||(A[1]=(...C)=>i(S).onMousedown&&i(S).onMousedown(...C)),onMouseup:A[2]||(A[2]=(...C)=>i(S).onMouseup&&i(S).onMouseup(...C))},[W(i(Ao),{loop:"",trapped:i(u),"focus-start-el":"container",onFocusAfterTrapped:i(_),onFocusAfterReleased:i(x),onFocusoutPrevented:i(M),onReleaseRequested:i(T)},{default:B(()=>[i(m)?(P(),ae(Vo,Lt({key:0,ref_key:"dialogContentRef",ref:c},p.$attrs,{"custom-class":p.customClass,center:p.center,"align-center":p.alignCenter,"close-icon":p.closeIcon,draggable:i(k),fullscreen:p.fullscreen,"show-close":p.showClose,title:p.title,"aria-level":p.headerAriaLevel,onClose:i(y)}),kt({header:B(()=>[p.$slots.title?I(p.$slots,"title",{key:1}):I(p.$slots,"header",{key:0,close:i(y),titleId:i(d),titleClass:i(n).e("title")})]),default:B(()=>[I(p.$slots,"default")]),_:2},[p.$slots.footer?{name:"footer",fn:B(()=>[I(p.$slots,"footer")])}:void 0]),1040,["custom-class","center","align-center","close-icon","draggable","fullscreen","show-close","title","aria-level","onClose"])):re("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,jo)]),_:3},8,["mask","overlay-class","z-index"]),[[At,i(u)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"]))}});var Go=Re(Yo,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog.vue"]]);const zo=to(Go);var ie,ce;class Xo{constructor(t,o,s){g(this,"moveState",{forward:!1,backward:!1,left:!1,right:!1,playerIsOnGround:!0});g(this,"playerVelocity",new G);g(this,"player");g(this,"temp",{upVector:new G(0,1,0),tempVector:new G,tempVector2:new G,tempBox:new Ft,tempMat:new Nt,tempSegment:new Ie});g(this,"params",{playerSpeed:12,gravity:-50});g(this,"controls");g(this,"camera");g(this,"capsuleInfo",{radius:1,segment:new Ie(new G,new G(0,-5,0))});N(this,ie,t=>{const{moveState:o}=this;switch(t.code){case"KeyW":case"ArrowUp":o.forward=!0;break;case"KeyS":case"ArrowDown":o.backward=!0;break;case"KeyA":case"ArrowLeft":o.left=!0;break;case"KeyD":case"ArrowRight":o.right=!0;break;case"Space":o.playerIsOnGround&&(this.playerVelocity.y=20,o.playerIsOnGround=!1)}});N(this,ce,t=>{const{moveState:o}=this;switch(t.code){case"KeyW":case"ArrowUp":o.forward=!1;break;case"KeyS":case"ArrowDown":o.backward=!1;break;case"KeyA":case"ArrowLeft":o.left=!1;break;case"KeyD":case"ArrowRight":o.right=!1;break}});g(this,"reset",()=>{const{playerVelocity:t,player:o,camera:s,controls:n}=this;t.set(0,0,0),o.position.set(0,5,0),s.position.sub(n.target),n.target.copy(o.position),s.position.add(o.position),n.update()});le("keydown",he(this,ie)),le("keyup",he(this,ce)),this.player=t,this.controls=o,this.camera=s}updatePlayer(t,o){const{playerVelocity:s,player:n,params:r,controls:l,camera:c}=this,{playerIsOnGround:u,forward:d,backward:b,right:w,left:E}=this.moveState,{upVector:m,tempVector:a}=this.temp;u?s.y=t*r.gravity:s.y+=t*r.gravity,n.position.addScaledVector(s,t);const f=l.getAzimuthalAngle();d&&(a.set(0,0,-1).applyAxisAngle(m,f),n.position.addScaledVector(a,r.playerSpeed*t)),b&&(a.set(0,0,1).applyAxisAngle(m,f),n.position.addScaledVector(a,r.playerSpeed*t)),E&&(a.set(-1,0,0).applyAxisAngle(m,f),n.position.addScaledVector(a,r.playerSpeed*t)),w&&(a.set(1,0,0).applyAxisAngle(m,f),n.position.addScaledVector(a,r.playerSpeed*t)),n.updateMatrixWorld();const{tempBox:h,tempMat:v,tempSegment:y,tempVector2:R}=this.temp,_=this.capsuleInfo;h.makeEmpty(),v.copy(o.matrixWorld).invert(),y.copy(_.segment),y.start.applyMatrix4(n.matrixWorld).applyMatrix4(v),y.end.applyMatrix4(n.matrixWorld).applyMatrix4(v),h.expandByPoint(y.start),h.expandByPoint(y.end),h.min.addScalar(-_.radius),h.max.addScalar(_.radius),o.geometry.boundsTree.shapecast({intersectsBounds:S=>S.intersectsBox(h),intersectsTriangle:S=>{const k=a,p=R,A=S.closestPointToSegment(y,k,p);if(A<_.radius){const C=_.radius-A,Z=p.sub(k).normalize();y.start.addScaledVector(Z,C),y.end.addScaledVector(Z,C)}}});const x=a;x.copy(y.start).applyMatrix4(o.matrixWorld);const T=R;T.subVectors(x,n.position),this.moveState.playerIsOnGround=T.y>Math.abs(t*s.y*.25);const M=Math.max(0,T.length()-1e-5);T.normalize().multiplyScalar(M),n.position.add(T),u?s.set(0,0,0):(T.normalize(),s.addScaledVector(T,-T.dot(s))),c.position.sub(l.target),l.target.copy(n.position),c.position.add(n.position),n.position.y<-25&&this.reset()}get isMoving(){const{forward:t,backward:o,left:s,right:n,playerIsOnGround:r}=this.moveState;return t||o||s||n||!r}}ie=new WeakMap,ce=new WeakMap;const qo=[new URL("/WebglStudy/assets/1-91d1fd28.png",self.location).href,new URL("/WebglStudy/assets/2-577e2981.png",self.location).href,new URL("/WebglStudy/assets/3-e96f4416.jpg",self.location).href,new URL("/WebglStudy/assets/4-2c59a331.jpg",self.location).href,new URL("/WebglStudy/assets/5-c8aed110.png",self.location).href,new URL("/WebglStudy/assets/6-9d09d2dc.png",self.location).href,new URL("/WebglStudy/assets/7-68ca4bc6.png",self.location).href,new URL("/WebglStudy/assets/8-74f5f15e.jpg",self.location).href,new URL("/WebglStudy/assets/9-44142f78.jpg",self.location).href,new URL("/WebglStudy/assets/10-1cde4a43.png",self.location).href],Ee={1:{title:"《小橘贝》",author:"小雅",describe:`
		它站在画面中央，静静地凝视着观众，柔和的橘色将它的柔软毛发和灵动眼眸妩媚地勾勒出来。<br>
		小猫的小耳朵微微竖起，似乎在倾听着什么，身体略微前倾，展现出它对周围世界的好奇和敏感。<br>
		画面的背景色以淡蓝色为主，这种色彩营造了温馨轻柔的氛围，让人仿佛置身于阳光明媚的午后时光中。<br>
		整个画作细致精致、色彩明亮而温暖，带给人们一种温馨、亲切的感受。
		`},2:{title:"《微光》",author:"小雅",describe:`
		微小的星光和银河组成了一个神秘的宇宙世界，让人感到无限的遐想和想象。<br>
		当你凝视着这幅画时，你会感受到无边无际的深邃和宁静。<br>
		你仿佛置身于一个没有噪音、没有烦扰的夜空中。在这个宁静的空间里，你可以看到银河中微光闪烁的样子。<br>
		这些微光似乎是夜空中唯一的生命体，它们微弱却坚定地发出光芒，点亮着整个银河系。<br>
		这些微光是如此的纤细而又强大，仿佛在无边的黑暗中，只有它们才能给人带来希望和力量。
		`},3:{title:"《天鹅》",author:"小雅",describe:`
		湖面静谧如镜，微风拂过，泛起一圈圈细微的涟漪，仿佛为优雅的白色天鹅们铺上了一层晶莹剔透的纱帐。<br>
		其中一只白羽如雪的天鹅在水中自由自在地舞动着优美的姿态，如同一位华丽的舞者在水上翩翩起舞。<br>
		纯白色羽毛在阳光的照射下，闪烁着淡淡的光晕，如同珍珠一般璀璨夺目。
		`},4:{title:"《山中小屋》",author:"小雅",describe:`
		宁静而恬淡，远山隐现于云雾中，仿佛是一幅梦幻般的画卷。<br>
		小屋在山脚下宁静地伫立，墙体洁白，屋顶泛着淡淡的阳光，使得小屋与周围的环境相互映衬。<br>
		流露出一种自然的和谐之美。
		`},5:{title:"《太空人》",author:"小雅",describe:`
		太空人身披着黑夜在星罗棋布的宇宙中漫游。<br>
		虽说现在已经是太空时代，人类早就可以坐太空飞船去月球，<br>
		但却永远无法探索别人内心的宇宙。
		`},6:{title:"《粉色海洋》",author:"小雅",describe:`
		粉色云朵蓬松如棉花糖展开眼前，弯月微笑在缝隙间，月光柔和，清雅动人。<br>
		紫色天空如梦，星辉闪烁，默默倾听，轻轻地，微风拂面，悄悄地，生命在流动。
		`},7:{title:"《风平浪静》",author:"小雅",describe:`
		撑一条船，离开岸边一百米，风平浪静，彩霞慢慢淡下去。<br>
		撑一条船，离开岸边两百米，风平浪静，夜晚轻轻呼唤你。<br>
		撑一条船，离开岸边三百米，风平浪静，大鱼笑我傻兮兮。<br>
		撑一条船 离开岸边四百米，风平浪静，星儿闪闪笑眯眯。<br>
		撑一条船 离开岸边五百米，风平浪静，海龟向我挥手臂。
		`},8:{title:"《向日葵》",author:"小雅",describe:`
		阳光照耀，金黄的花盘。<br>
		宛如一盏明灯，指引前行。<br>
		向日葵，你是信仰，你是力量，你是光辉，你是坚毅，你是忠诚，你是爱慕，你是美丽。
		`},9:{title:"《花·虎·蝶》",author:"小雅",describe:`
		一段奇妙的相遇，是自由和勇气的结合，是一份神秘而又动人的韵味。<br>
		在这片色彩斑斓的花海之中，一只带着蝴蝶翅膀的老虎，骑着踏板车，<br>
		它像是一道闪电，划破了这片美好的天地。<br>
		翅膀轻轻地振动，仿佛随时可以飞离这片美好的天地，飞向更广阔的天空。
		`},10:{title:"《豚》",author:"小雅",describe:`
		所有的转折隐藏在密集的鸟群中，天空与海洋都无法察觉，怀着美梦却可以看见。<br>
		摸索颠倒的一瞬间，所有的怀念隐藏在相似的日子里，心里的蜘蛛模仿人类张灯结彩
		`}},$={width:window.innerWidth,height:window.innerHeight},Le=L();var de,lt,ue,it,fe,ct,pe,dt,me,ut;class Jo{constructor(t){N(this,de);N(this,ue);N(this,fe);N(this,pe);N(this,me);g(this,"loader",new qt);g(this,"textureLoader",new Ut);g(this,"collisionScene");g(this,"textureBoards",{});g(this,"galleryBoards",{});g(this,"raycastObjects",[]);g(this,"loaded",L(!1));g(this,"scene");this.scene=t,Y(this,me,ut).call(this),Y(this,ue,it).call(this);const o=[Y(this,de,lt).call(this),Y(this,fe,ct).call(this)];Promise.all(o).then(()=>{Y(this,pe,dt).call(this),this.loaded.value=!0})}}de=new WeakSet,lt=function(){const{loader:t,scene:o}=this;return new Promise((s,n)=>{t.load("model/scene_collision.glb",r=>{const l=r.scene;l.updateMatrixWorld(!0),this.collisionScene=l,l.traverse(d=>{(d.name==="home001"||d.name==="PointLight")&&(d.castShadow=!0),d.name.includes("PointLight")&&d instanceof Vt&&(d.intensity*=2e3),d.name==="home002"&&(d.castShadow=!0,d.receiveShadow=!0),d instanceof Te&&/gallery.*_board/.test(d.name)&&(this.galleryBoards[d.name]=d,this.raycastObjects.push(d))});const c=new It(this.collisionScene);c.attributes=["position"];const u=c.generate();u.boundsTree=new Pt(u),Le.value=new Te(u),o.add(l),s(r)})})},ue=new WeakSet,it=function(){const{loader:t,scene:o}=this;return new Promise(s=>{t.load("model/scene_desk_obj.glb",n=>{const r=n.scene;o.add(r),s(n)})})},fe=new WeakSet,ct=async function(){const{textureLoader:t,textureBoards:o}=this,s=[];function n(r){r.colorSpace=Qe;const l=r.image.width/r.image.height;let c=1,u=1;l>1?c=1/l:u=l,r.offset.set(.5-c/2,.5-u/2),r.repeat.set(c,u)}for(const[r,l]of qo.entries()){const c=new Promise(u=>{t.load(l,d=>{n(d),o[r+1]=d,u(d)})});s.push(c)}return await Promise.all(s),o},pe=new WeakSet,dt=function(){const{textureBoards:t,galleryBoards:o}=this;for(const s in t){const n=o[`gallery${s}_board`],r=n.material;r.map=t[s],n.userData={name:n.name,title:Ee[s].title,author:Ee[s].author,describe:Ee[s].describe,index:s,src:t[s].image.src,show_boards:!0},[4,5,6,7,9].includes(+s)&&(n.rotation.y=-Math.PI/2),+s==8&&(n.rotation.y=Math.PI)}},me=new WeakSet,ut=function(){const t=new Jt(new $t(100,100),{textureWidth:$.width*window.devicePixelRatio,textureHeight:$.height*window.devicePixelRatio,color:16777215});t.material instanceof Wt&&(t.material.transparent=!0,t.material.fragmentShader=t.material.fragmentShader.replace("gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 )","gl_FragColor = vec4( blendOverlay( base.rgb, color ), 0.1 )")),t.rotation.x=-Math.PI/2,this.scene.add(t)};class Zo{constructor(t){g(this,"camera");g(this,"hoverPoint",new Pe(0,0));g(this,"tooltipRaycaster",new Be);g(this,"raycastObjects",[]);g(this,"bindClickRayCastObj",(t=[],o)=>{let s=0,n=0;le("mousedown",r=>{s=r.screenX,n=r.screenY}),this.raycastObjects=t,le("mouseup",r=>{const l=Math.abs(r.screenX-s),c=Math.abs(r.screenY-n);if(l>1||c>1)return;const u=new Pe(r.clientX/$.width*2-1,1-r.clientY/$.height*2),d=new Be;d.far=18,d.setFromCamera(u,this.camera);const b=d.intersectObjects(t);b.length&&o(b[0].object)})});this.camera=t,this.tooltipRaycaster.far=15}updateTooltipRayCast(t,o){if(this.raycastObjects.length){this.tooltipRaycaster.setFromCamera(this.hoverPoint,this.camera);const s=this.tooltipRaycaster.intersectObjects(this.raycastObjects);s.length&&s[0].object.userData.title?t(s[0].object):o()}}}const Qo={class:"tracking-wider select-none",text:"white"},es={class:"fixed bottom-190px left-1/2 -translate-x-1/2 leading-40px px-20px rounded bg-black/40"},ts=D("footer",{class:"fixed bottom-20px left-1/2 -translate-x-1/2 leading-40px rounded bg-black/40 w-50vw text-center"},"Tips：点击此画可查看详情",-1),os=F({__name:"Tip",props:{title:{}},setup(e){return(t,o)=>(P(),X("div",Qo,[D("header",es,ne(t.title),1),ts]))}}),ss={class:"flex justify-between gap-x-40px tracking-wider leading-32px",text:"16px white"},ns={class:"font-bold",text:"20px"},as=["innerHTML"],rs=["src"],ls=F({__name:"Detail",props:{data:{}},setup(e){return(t,o)=>(P(),X("div",ss,[D("aside",null,[D("header",ns,ne(t.data.title),1),D("p",null,"作者："+ne(t.data.author),1),D("footer",{class:"text-justify leading-40px",innerHTML:t.data.describe},null,8,as)]),D("img",{src:t.data.src,alt:"",class:"w-670px h-500px"},null,8,rs)]))}}),is=F({__name:"Index",setup(e){const t=new Kt,o=new jt(55,$.width/$.height,.1,1e3);o.position.set(0,0,3);const s=new Ht({antialias:!0});s.setSize($.width,$.height),s.setPixelRatio(window.devicePixelRatio),s.shadowMap.enabled=!0,s.outputColorSpace=Qe,s.toneMapping=Yt;const n=xt();q(()=>{n.value.appendChild(s.domElement)});const r=new Dt(o,s.domElement);r.minDistance=1e-4,r.maxDistance=1e-4;const l=new Jo(t),c=new Zo(o);j(l.loaded,v=>{v&&c.bindClickRayCastObj(l.raycastObjects,h)});const u=new Te(new Bt(.5,2.5,.5,10,1),new Gt({color:255}));u.geometry.translate(0,-.25,0),t.add(u);const d=new Xo(u,r,o);d.reset();const b=new zt;s.setAnimationLoop(()=>{s.render(t,o),r.update();const v=Math.min(b.getDelta(),.05);Le.value&&d.updatePlayer(v,Le.value),d.isMoving&&c.updateTooltipRayCast(E,m)});const w=L();function E(v){w.value=v.userData.title}function m(){w.value=null}const a=L(!1),f=L();function h(v){f.value=v.userData,a.value=!a.value}return Mt(()=>{Xt(t,s)}),(v,y)=>{const R=zo;return P(),X(Ot,null,[D("div",{ref_key:"containerRef",ref:n},null,512),W(Ze,{appear:"",name:"fade"},{default:B(()=>[i(w)?(P(),ae(os,{key:0,title:i(w)},null,8,["title"])):re("",!0)]),_:1}),W(R,{modelValue:i(a),"onUpdate:modelValue":y[0]||(y[0]=_=>Xe(a)?a.value=_:null),width:"70vw",class:"!bg-black !rounded-20px"},{default:B(()=>[W(ls,{data:i(f)},null,8,["data"])]),_:1},8,["modelValue"])],64)}}});const Ls=co(is,[["__scopeId","data-v-4b871fcc"]]);export{Ls as default};
