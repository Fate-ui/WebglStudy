import{X as ne,Y as z,V as h,K as f,v as B,_ as ie,S as se,P as ae,G as ce,r as re}from"./three.module-e7d85b12.js";import{C as pe,a as de}from"./CSS3DRenderer-fb0f148c.js";import{a as le}from"./index-b9081dda.js";import{d as me}from"./index-1a26f821.js";import{d as he,s as ue,l as fe,p as ye,o as ge,c as be}from"./index-ef070050.js";const R={type:"change"},Z={type:"start"},I={type:"end"};class Ee extends ne{constructor(j,T){super();const e=this,n={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=j,this.domElement=T,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:z.ROTATE,MIDDLE:z.DOLLY,RIGHT:z.PAN},this.target=new h;const S=1e-6,y=new h;let u=1,a=n.NONE,l=n.NONE,C=0,P=0,k=0;const r=new h,p=new f,s=new f,x=new h,m=new f,w=new f,b=new f,O=new f,i=[],N={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const t=e.domElement.getBoundingClientRect(),o=e.domElement.ownerDocument.documentElement;e.screen.left=t.left+window.pageXOffset-o.clientLeft,e.screen.top=t.top+window.pageYOffset-o.clientTop,e.screen.width=t.width,e.screen.height=t.height};const M=function(){const t=new f;return function(c,d){return t.set((c-e.screen.left)/e.screen.width,(d-e.screen.top)/e.screen.height),t}}(),_=function(){const t=new f;return function(c,d){return t.set((c-e.screen.width*.5-e.screen.left)/(e.screen.width*.5),(e.screen.height+2*(e.screen.top-d))/e.screen.width),t}}();this.rotateCamera=function(){const t=new h,o=new ie,c=new h,d=new h,g=new h,E=new h;return function(){E.set(s.x-p.x,s.y-p.y,0);let D=E.length();D?(r.copy(e.object.position).sub(e.target),c.copy(r).normalize(),d.copy(e.object.up).normalize(),g.crossVectors(d,c).normalize(),d.setLength(s.y-p.y),g.setLength(s.x-p.x),E.copy(d.add(g)),t.crossVectors(E,r).normalize(),D*=e.rotateSpeed,o.setFromAxisAngle(t,D),r.applyQuaternion(o),e.object.up.applyQuaternion(o),x.copy(t),k=D):!e.staticMoving&&k&&(k*=Math.sqrt(1-e.dynamicDampingFactor),r.copy(e.object.position).sub(e.target),o.setFromAxisAngle(x,k),r.applyQuaternion(o),e.object.up.applyQuaternion(o)),p.copy(s)}}(),this.zoomCamera=function(){let t;a===n.TOUCH_ZOOM_PAN?(t=C/P,C=P,e.object.isPerspectiveCamera?r.multiplyScalar(t):e.object.isOrthographicCamera?(e.object.zoom=B.clamp(e.object.zoom/t,e.minZoom,e.maxZoom),u!==e.object.zoom&&e.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(t=1+(w.y-m.y)*e.zoomSpeed,t!==1&&t>0&&(e.object.isPerspectiveCamera?r.multiplyScalar(t):e.object.isOrthographicCamera?(e.object.zoom=B.clamp(e.object.zoom/t,e.minZoom,e.maxZoom),u!==e.object.zoom&&e.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),e.staticMoving?m.copy(w):m.y+=(w.y-m.y)*this.dynamicDampingFactor)},this.panCamera=function(){const t=new f,o=new h,c=new h;return function(){if(t.copy(O).sub(b),t.lengthSq()){if(e.object.isOrthographicCamera){const g=(e.object.right-e.object.left)/e.object.zoom/e.domElement.clientWidth,E=(e.object.top-e.object.bottom)/e.object.zoom/e.domElement.clientWidth;t.x*=g,t.y*=E}t.multiplyScalar(r.length()*e.panSpeed),c.copy(r).cross(e.object.up).setLength(t.x),c.add(o.copy(e.object.up).setLength(t.y)),e.object.position.add(c),e.target.add(c),e.staticMoving?b.copy(O):b.add(t.subVectors(O,b).multiplyScalar(e.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!e.noZoom||!e.noPan)&&(r.lengthSq()>e.maxDistance*e.maxDistance&&(e.object.position.addVectors(e.target,r.setLength(e.maxDistance)),m.copy(w)),r.lengthSq()<e.minDistance*e.minDistance&&(e.object.position.addVectors(e.target,r.setLength(e.minDistance)),m.copy(w)))},this.update=function(){r.subVectors(e.object.position,e.target),e.noRotate||e.rotateCamera(),e.noZoom||e.zoomCamera(),e.noPan||e.panCamera(),e.object.position.addVectors(e.target,r),e.object.isPerspectiveCamera?(e.checkDistances(),e.object.lookAt(e.target),y.distanceToSquared(e.object.position)>S&&(e.dispatchEvent(R),y.copy(e.object.position))):e.object.isOrthographicCamera?(e.object.lookAt(e.target),(y.distanceToSquared(e.object.position)>S||u!==e.object.zoom)&&(e.dispatchEvent(R),y.copy(e.object.position),u=e.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){a=n.NONE,l=n.NONE,e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.up.copy(e.up0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),r.subVectors(e.object.position,e.target),e.object.lookAt(e.target),e.dispatchEvent(R),y.copy(e.object.position),u=e.object.zoom};function Y(t){e.enabled!==!1&&(i.length===0&&(e.domElement.setPointerCapture(t.pointerId),e.domElement.addEventListener("pointermove",A),e.domElement.addEventListener("pointerup",L)),te(t),t.pointerType==="touch"?K(t):G(t))}function A(t){e.enabled!==!1&&(t.pointerType==="touch"?$(t):Q(t))}function L(t){e.enabled!==!1&&(t.pointerType==="touch"?ee(t):J(),q(t),i.length===0&&(e.domElement.releasePointerCapture(t.pointerId),e.domElement.removeEventListener("pointermove",A),e.domElement.removeEventListener("pointerup",L)))}function X(t){q(t)}function v(t){e.enabled!==!1&&(window.removeEventListener("keydown",v),l===n.NONE&&(t.code===e.keys[n.ROTATE]&&!e.noRotate?l=n.ROTATE:t.code===e.keys[n.ZOOM]&&!e.noZoom?l=n.ZOOM:t.code===e.keys[n.PAN]&&!e.noPan&&(l=n.PAN)))}function U(){e.enabled!==!1&&(l=n.NONE,window.addEventListener("keydown",v))}function G(t){if(a===n.NONE)switch(t.button){case e.mouseButtons.LEFT:a=n.ROTATE;break;case e.mouseButtons.MIDDLE:a=n.ZOOM;break;case e.mouseButtons.RIGHT:a=n.PAN;break}const o=l!==n.NONE?l:a;o===n.ROTATE&&!e.noRotate?(s.copy(_(t.pageX,t.pageY)),p.copy(s)):o===n.ZOOM&&!e.noZoom?(m.copy(M(t.pageX,t.pageY)),w.copy(m)):o===n.PAN&&!e.noPan&&(b.copy(M(t.pageX,t.pageY)),O.copy(b)),e.dispatchEvent(Z)}function Q(t){const o=l!==n.NONE?l:a;o===n.ROTATE&&!e.noRotate?(p.copy(s),s.copy(_(t.pageX,t.pageY))):o===n.ZOOM&&!e.noZoom?w.copy(M(t.pageX,t.pageY)):o===n.PAN&&!e.noPan&&O.copy(M(t.pageX,t.pageY))}function J(){a=n.NONE,e.dispatchEvent(I)}function H(t){if(e.enabled!==!1&&e.noZoom!==!0){switch(t.preventDefault(),t.deltaMode){case 2:m.y-=t.deltaY*.025;break;case 1:m.y-=t.deltaY*.01;break;default:m.y-=t.deltaY*25e-5;break}e.dispatchEvent(Z),e.dispatchEvent(I)}}function K(t){switch(F(t),i.length){case 1:a=n.TOUCH_ROTATE,s.copy(_(i[0].pageX,i[0].pageY)),p.copy(s);break;default:a=n.TOUCH_ZOOM_PAN;const o=i[0].pageX-i[1].pageX,c=i[0].pageY-i[1].pageY;P=C=Math.sqrt(o*o+c*c);const d=(i[0].pageX+i[1].pageX)/2,g=(i[0].pageY+i[1].pageY)/2;b.copy(M(d,g)),O.copy(b);break}e.dispatchEvent(Z)}function $(t){switch(F(t),i.length){case 1:p.copy(s),s.copy(_(t.pageX,t.pageY));break;default:const o=oe(t),c=t.pageX-o.x,d=t.pageY-o.y;P=Math.sqrt(c*c+d*d);const g=(t.pageX+o.x)/2,E=(t.pageY+o.y)/2;O.copy(M(g,E));break}}function ee(t){switch(i.length){case 0:a=n.NONE;break;case 1:a=n.TOUCH_ROTATE,s.copy(_(t.pageX,t.pageY)),p.copy(s);break;case 2:a=n.TOUCH_ZOOM_PAN;for(let o=0;o<i.length;o++)if(i[o].pointerId!==t.pointerId){const c=N[i[o].pointerId];s.copy(_(c.x,c.y)),p.copy(s);break}break}e.dispatchEvent(I)}function V(t){e.enabled!==!1&&t.preventDefault()}function te(t){i.push(t)}function q(t){delete N[t.pointerId];for(let o=0;o<i.length;o++)if(i[o].pointerId==t.pointerId){i.splice(o,1);return}}function F(t){let o=N[t.pointerId];o===void 0&&(o=new f,N[t.pointerId]=o),o.set(t.pageX,t.pageY)}function oe(t){const o=t.pointerId===i[0].pointerId?i[1]:i[0];return N[o.pointerId]}this.dispose=function(){e.domElement.removeEventListener("contextmenu",V),e.domElement.removeEventListener("pointerdown",Y),e.domElement.removeEventListener("pointercancel",X),e.domElement.removeEventListener("wheel",H),e.domElement.removeEventListener("pointermove",A),e.domElement.removeEventListener("pointerup",L),window.removeEventListener("keydown",v),window.removeEventListener("keyup",U)},this.domElement.addEventListener("contextmenu",V),this.domElement.addEventListener("pointerdown",Y),this.domElement.addEventListener("pointercancel",X),this.domElement.addEventListener("wheel",H,{passive:!1}),window.addEventListener("keydown",v),window.addEventListener("keyup",U),this.handleResize(),this.update()}}const ke=he({__name:"15.嵌入可交互网页",setup(W){const j={width:window.innerWidth,height:window.innerHeight},T=new se,e=new ae(50,j.width/j.height,1,5e3);e.position.set(500,350,750);const n=new pe;n.setSize(j.width,j.height);const S=ue();let y;fe(()=>{S.value.appendChild(n.domElement),y=new Ee(e,n.domElement),y.rotateSpeed=4}),T.add(new ce(1e3,300)),le(()=>{y.update(),n.render(T,e)});function u(l,C,P,k,r){const p=document.createElement("div");p.style.width="480px",p.style.height="360px",p.style.backgroundColor="#000";const s=document.createElement("iframe");s.style.width="480px",s.style.height="360px",s.style.border="0px",s.src=l,p.appendChild(s);const x=new de(p);return x.position.set(C,P,k),x.rotation.y=r,x}const a=new re;return a.add(u("https://fate-ui.github.io/flowChart/#/home",0,0,240,0)),a.add(u("https://fate-ui.github.io/WebglStudy/#/threeJsTest/Exhibition",240,0,0,Math.PI/2)),a.add(u("https://fate-ui.github.io/WebglStudy/#/threeJsTest/character",0,0,-240,Math.PI)),a.add(u("https://fate-ui.github.io/WebglStudy/#/threeJsModel/starCloud",-240,0,0,-Math.PI/2)),T.add(a),ye(()=>{me(T,n)}),(l,C)=>(ge(),be("div",{ref_key:"containerRef",ref:S},null,512))}});export{ke as default};
